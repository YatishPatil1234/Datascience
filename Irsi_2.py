import pandas as pd
from sklearn.model_selection import train_test_split

df=pd.read_csv("C:/Users/91775/Downloads/Dataset/Iris.csv")
X=df.drop("class",axis=1)
y=df["class"]
# print(X)
# print(y)
X_train,X_test,y_train,y_test=train_test_split(X,y,random_state=0,test_size=0.3)
#print(X_train)
#print(X_test)
# print(y_train)
#print(Y_test)
#Random over sampling
from imblearn.over_sampling import RandomOverSampler
ros=RandomOverSampler(random_state=0)
X,y=ros.fit_resample(X,y)

# print(ros.fit_resample(X,y))
# Synthetic minority oversampling
from imblearn.over_sampling import SMOTE
sms=SMOTE(random_state=0)
X,y=sms.fit_resample(X,y)
# print(sms.fit_resample(X,y))

# under sampling
from  imblearn.under_sampling import RandomUnderSampler
rus=RandomUnderSampler(random_state=0)
X,y=rus.fit_resample(X,y)

# print(rus.fit_resample(X,y))

# identifying Outlier using interquantile range
print(df['sepal_length'])
Q1=df['sepal_length'].quantile(0.25)
Q2=df['sepal_length'].quantile(0.75)

IQR= Q2-Q1
print(IQR)

upper=Q2+1.5*IQR
lower=Q1-1.5*IQR
print(upper)
print(lower)

out1=df[df['sepal_length'] < lower].values
out2=df[df['sepal_length']>upper].values

df['sepal_length'].replace(out1,lower,inplace=True)
df['sepal_length'].replace(out2,upper,inplace=True)

print(df['sepal_length'])

#  Principal component analysis

from sklearn.decomposition import PCA
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score
logr=LogisticRegression()
pca=PCA(n_components=2)
pca.fit(X)
X=pca.transform(X)

print(X)

"""
OUTPUT:
0      5.1
1      4.9
2      4.7
3      4.6
4      5.0
      ...
145    6.7
146    6.3
147    6.5
148    6.2
149    5.9
Name: sepal_length, Length: 150, dtype: float64
1.3000000000000007
8.350000000000001
3.1499999999999986
0      5.1
1      4.9
2      4.7
3      4.6
4      5.0
      ...
145    6.7
146    6.3
147    6.5
148    6.2
149    5.9
Name: sepal_length, Length: 150, dtype: float64
[[-2.68420713  0.32660731]
 [-2.71539062 -0.16955685]
 [-2.88981954 -0.13734561]
 [-2.7464372  -0.31112432]
 [-2.72859298  0.33392456]
 [-2.27989736  0.74778271]
 [-2.82089068 -0.08210451]
 [-2.62648199  0.17040535]
 [-2.88795857 -0.57079803]
 [-2.67384469 -0.1066917 ]
 [-2.50652679  0.65193501]
 [-2.61314272  0.02152063]
 [-2.78743398 -0.22774019]
 [-3.22520045 -0.50327991]
 [-2.64354322  1.1861949 ]
 [-2.38386932  1.34475434]
 [-2.6225262   0.81808967]
 [-2.64832273  0.31913667]
 [-2.19907796  0.87924409]
 [-2.58734619  0.52047364]
 [-2.3105317   0.39786782]
 [-2.54323491  0.44003175]
 [-3.21585769  0.14161557]
 [-2.30312854  0.10552268]
 [-2.35617109 -0.03120959]
 [-2.50791723 -0.13905634]
 [-2.469056    0.13788731]
 [-2.56239095  0.37468456]
 [-2.63982127  0.31929007]
 [-2.63284791 -0.19007583]
 [-2.58846205 -0.19739308]
 [-2.41007734  0.41808001]
 [-2.64763667  0.81998263]
 [-2.59715948  1.10002193]
 [-2.67384469 -0.1066917 ]
 [-2.86699985  0.0771931 ]
 [-2.62522846  0.60680001]
 [-2.67384469 -0.1066917 ]
 [-2.98184266 -0.48025005]
 [-2.59032303  0.23605934]
 [-2.77013891  0.27105942]
 [-2.85221108 -0.93286537]
 [-2.99829644 -0.33430757]
 [-2.4055141   0.19591726]
 [-2.20883295  0.44269603]
 [-2.71566519 -0.24268148]
 [-2.53757337  0.51036755]
 [-2.8403213  -0.22057634]
 [-2.54268576  0.58628103]
 [-2.70391231  0.11501085]
 [ 0.81245555 -0.16233157]
 [ 0.51109806 -0.10228411]
 [-0.5110862  -1.26249195]
 [ 0.89016045 -0.03381244]
 [ 1.46406132  0.50418983]
 [ 1.55739627  0.26739258]
 [ 0.24519516 -0.26672804]
 [-0.19188449 -0.67749054]
 [ 1.29646885 -0.32756152]
 [ 1.08713449  0.07539039]
 [ 1.37873698 -0.42120514]
 [ 0.8072055   0.19505396]
 [ 1.33104142  0.24466952]
 [ 0.58727485 -0.48328427]
 [ 0.94236171 -0.54182226]
 [-0.75146714 -1.00110751]
 [-0.174864   -0.25181557]
 [ 0.33112695 -0.21118014]
 [-0.90846333 -0.75156873]
 [-0.30733476 -0.36508661]
 [ 0.92757294  0.46823621]
 [-0.07034289 -0.70253793]
 [ 0.13499495 -0.31170964]
 [ 0.65959279 -0.35197629]
 [ 0.22887905 -0.40225762]
 [ 1.11624072 -0.08421401]
 [-0.70708128 -1.00842476]
 [ 1.04329778  0.22895691]
 [ 0.98404455 -0.12436042]
 [ 0.89964086  0.32961098]
 [ 0.64043675 -0.41732348]
 [ 0.23454059 -0.33192183]
 [ 0.46303099 -0.66952655]
 [ 0.29780791 -0.34701652]
 [ 0.93241075  0.31919809]
 [ 0.26233576 -0.5478933 ]
 [ 0.81286779 -0.370679  ]
 [ 0.71400821  0.15037915]
 [ 1.09522371  0.28389121]
 [ 0.92050265 -0.18239036]
 [ 1.22042897  0.40803534]
 [ 0.35678657 -0.06682383]
 [ 0.0432464  -0.58148945]
 [-0.01019007 -0.72057487]
 [ 0.16451343 -0.67966147]
 [ 0.37523823 -0.29162202]
 [ 0.18096721 -0.82560394]
 [ 1.28479459  0.68543919]
 [ 0.64169028  0.01907118]
 [ 0.35553304 -0.50321849]
 [ 2.61648461  0.34193529]
 [ 2.84096093  0.37274259]
 [ 1.38766825 -0.20403099]
 [ 1.94924878  0.04073026]
 [ 1.34459422 -0.77641543]
 [ 2.12285398 -0.21085488]
 [ 2.91813423  0.78038063]
 [ 1.94401705  0.18741522]
 [ 1.4431026  -0.14380129]
 [ 1.90486293  0.04804751]
 [ 1.52566363 -0.37502085]
 [ 2.9320051   0.35237701]
 [ 1.77964011 -0.50146479]
 [ 1.29832982 -0.76101394]
 [ 2.56332271  0.2759745 ]
 [ 2.15873837 -0.21832553]
 [ 2.31967279 -0.24554817]
 [ 3.49926548  0.45677347]
 [ 2.3875644   0.46251925]
 [ 2.41939122  0.30350394]
 [ 1.25762518 -0.179137  ]
 [ 1.41407223 -0.57492506]
 [ 2.27585365  0.33338653]
 [ 0.51938325 -1.19135169]
 [ 1.92245088  0.40927118]
 [ 1.90474358  0.11881899]
 [ 3.48876538  1.17154454]
 [ 2.31430339  0.18260885]
 [ 1.16885347 -0.1645025 ]
 [ 3.39687992  0.54716805]
 [ 2.14498686  0.13890661]
 [ 1.38966613 -0.28288671]
 [ 2.53172698 -0.01184224]]"""